# Elm Workshop

This workshop is designed to step you through the basics of elm and progress through to making an SPA like thing. 

To do this, we are going to implement a frontend for the board game Avalon (against a preexisting backend). This clone is ridiculously satirically FP themed and is not to be taken seriously, but should be a lot of fun to write. :)

## Setup

You'll need a few things before you can start:

- Checkout this code to your machine:
  - `git clone https://github.com/benkolera/elm-workshop.git`
- Install nodejs and npm
  - https://nodejs.org/en/download/package-manager/
  - Have npm setup to install global things into ~ https://github.com/sindresorhus/guides/blob/master/npm-global-without-sudo.md
- Your favourite text editor
  - If you use vscode, installing the elm plugin is super handy 
  - If you set formatOnSave to be true in vscode, having elm format installed is awesome `npm install -g elm-format`
- Install docker and start the backend:
  - https://docs.docker.com/install/
  - `docker run -ti -p8001:8001 benkolera/dissidence-backend:latest`
  - You should see `Starting server on port 8001`
- Start the frontend dev server:
  - run `npm install` in this directory 
  - run `npm run dev` to get the dev server running.
  - Visit http://localhost:1234 and you should see a happy page!
  - Open up src/Main.elm in vscode and change the text. Your page should be automatically reloaded!
- Start the fully implemented app:
  - Control-C the dev server from before 
  - cd ./dissidence/frontend
  - run `npm install` 
  - run `npm run dev` to get the dev server running.
  - Visit http://localhost:1234 and you should see a login page! If you can login with "user1" / "pass" everything is all good! :)

You're all set to go at this point!

## Project Layout

- package.json : Specifies our elm compiler and parcel version and the scripts to run parcel for us
- elm.json : The elm dependencies that our UI will use. 
- The following pieces are bundled together with parcel (the thing that gets run when you `npm run dev`):
  - src/index.html : The html file that is the basis of our SPA
  - src/app.scss : A premade sass stylesheet for the app
  - src/index.js : The javascript 
  - src/Main.elm : The main elm entrypoint
  - src/fonts : Some gratuitous fonts for the app
- api/Generated/Api.elm : This is an autogenerated set of backend calls that our app can call. It is generated by servant-elm. You would only care about servant-elm if you have a backend written in haskell, as it means that your UI and backend routes and types are much more easily kept in sync. If you don't have a haskell backend, you'd probably write that file by hand. 
- dissidence/ : This submodule is my fully finished version of the app. Go hunting in there for hints or just explore and tinker with it it if you prefer that to doing the workshop.



## Elm Basics

It's a good idea to learn the basics of elm syntax and ideas. https://guide.elm-lang.org/ is an excellent start. You should read the following sections:
- Core Language
- The Elm Architecture
- Types
- Error Handling
- HTTP
- Time

Keep this open, as well as: https://package.elm-lang.org/packages/elm/core/1.0.2/ 

## How to engage with this workshop

There is way too much to get done in a single sitting. Don't feel daunted by this: the idea is that the workshop starts you off and gets you moving and you can finish the rest later if you are keen. 

If this workshop feels too much of a deep end for you, check out https://elmprogramming.com/ for a much slower paced intro that explains the motivations behind certain designs. It is still for Elm 0.18 so there will be some things that don't compile. Sing out for help if you hit things like that. Always check the docs for the libary at package.elm-lang.org.

If you are ready to write the SPA, check out the description of the app in dissidence/README.md. We'll step by step build this starting page into a full implementation of the frontend for the game. This is definitely a challenge, but the backend does most of the heavy lifting of maintaining the game state.

What is really helpful is that you can stop the frontend server (the `npm run dev` thing) and then run the fully implemented one. They both talk to the same database, so it's nice to be able to see what the real one does. Lean on this if my descriptions are confusing.

The page should live reload as you make changes and you should even see compile errors in the browser window. It's a good idea to keep that window visible so you get constant and quick feedback.

## Exercise 1: Login Form

The first thing that we are going to do is make the login form and have that submitting to the backend. 

Remember that you can reread https://guide.elm-lang.org/architecture/forms.html if this doesn't make sense yet.

### Basic Form

We'll take it easy at this point. Replace the entire view with this snippet:

```elm
    H.div [ HA.class "login-box" ]
        [ H.h1 [] [ H.text "Login" ]
        , H.form []
            [ H.input
                [ HA.placeholder "Player Id"
                , HAA.ariaLabel "Player ID"
                ]
                []
            , H.input
                [ HA.placeholder "Password"
                , HA.type_ "password"
                , HAA.ariaLabel "Password"
                ]
                []
            , H.button
                [ HA.class "btn primary" ]
                [ H.text "Login" ]
            ]
        ]
```

Your browser should reload as soon as you save this.

### Form Model

Lets wire the form up to some model state. 

- Add a playerId : String and password : String to the model record. 
- Don't forget to initialise these to empty string in the init function.
- Add a SetPlayerId and SetPassword to the Msg sum type

### Sending the backend call off

## Exercise 2: Register Form

## Exercise 3: Lobby Chat Box

## Exercise 5: Refactor

## Exercise 6: New Game / Join Game

## Exercise 7: Waiting For Players State

## Exercise 8: Pregame State

## Exercise 9: Rounds - Propose Team State

## Exercise 10: Rounds - Team Vote State

## Exercise 10: Rounds - Project Vote State

## Exercise 11: Firing Round

## Exercise 12: Completed